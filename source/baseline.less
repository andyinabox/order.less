// = = = = = = = =
// baseline.less =
// = = = = = = = =
.use-baseline (@font-size, @line-height, @offset: 0.35) when (ispixel(@font-size)) {
	
	@baseline-font-size: @font-size;
	@baseline-line-height: @line-height;
	@baseline-offset: @offset;
	
	// Baseline height
	.baseline-height (@span) {
		.baseline-property(height, @span);
	}
	.baseline-height (@span, @offset) {
		.baseline-property(height, @span, @offset);
	}
	.baseline-min-height (@span) {
		.baseline-property(min-height, @span);
	}
	.baseline-min-height (@span, @offset) {
		.baseline-property(min-height, @span, @offset);
	}
	.baseline-max-height (@span) {
		.baseline-property(max-height, @span);
	}
	.baseline-max-height (@span, @offset) {
		.baseline-property(max-height, @span, @offset);
	}
	
	// Baseline offset
	.baseline-top (@span) {
		.baseline-property(top, @span);
	}
	.baseline-top (@span, @offset) {
		.baseline-property(top, @span, @offset);
	}
	.baseline-bottom (@span) {
		.baseline-property(bottom, @span);
	}
	.baseline-bottom (@span, @offset) {
		.baseline-property(bottom, @span, @offset);
	}
	
	// Baseline padding
	.baseline-padding-top (@span) {
		.baseline-property(padding-top, @span);
	}
	.baseline-padding-top (@span, @offset) {
		.baseline-property(padding-top, @span, @offset);
	}
	.baseline-padding-bottom (@span) {
		.baseline-property(padding-bottom, @span);
	}
	.baseline-padding-bottom (@span, @offset) {
		.baseline-property(padding-bottom, @span, @offset);
	}
	
	// Baseline margin
	.baseline-margin-top (@span) {
		.baseline-property(margin-top, @span);
	}
	.baseline-margin-top (@span, @offset) {
		.baseline-property(margin-top, @span, @offset);
	}
	.baseline-margin-bottom (@span) {
		.baseline-property(margin-bottom, @span);
	}
	.baseline-margin-bottom (@span, @offset) {
		.baseline-property(margin-bottom, @span, @offset);
	}
	
	// Calculate baseline values
	.calculate-baseline-vars (@span, @base: @baseline-font-size) {
		@-line-height-px: round((@span * @baseline-font-size * @baseline-line-height), 8);
		@-line-height-rem: round(unit((@span * @baseline-line-height), rem), 8);
		@-line-height: round(unit((@span * @baseline-line-height * @baseline-font-size / @base), em), 8);
	}
	
	// Set property values
	.baseline-property (@property, @span) {
		.calculate-baseline-vars(@span);
		
		@{property}: @-line-height-px;
		@{property}: @-line-height-rem;
	}
	.baseline-property (@property, @span, @offset) {
		.calculate-baseline-vars(@span);
		
		@{property}: @-line-height-px;
		@{property}: -webkit-calc(@-line-height-rem ~"+" @offset);
		@{property}: calc(@-line-height-rem ~"+" @offset);
	}
	
	// Adjust baseline parameters for new font size, line height and offset
	.adjust-baseline (@-font-size, @baseline-ratio: 1, @offset: @baseline-offset) when (ispixel(@-font-size)) {
		
		@adjusted-font-size: @-font-size;
		@adjusted-line-height: (@line-height * @baseline-ratio);
		
		@-diff-line-height: (@baseline-line-height * @baseline-font-size - @adjusted-line-height * @adjusted-font-size);
		@-diff-font-size: (@adjusted-font-size * @offset - @baseline-font-size * @baseline-offset);
		
		// Offsets
		@offset-top: (unit(mod(@-diff-line-height / 2 - @-diff-font-size, @baseline-font-size * @baseline-line-height) / @adjusted-font-size, em));
		@offset-bottom: (unit(mod(@-diff-line-height, @baseline-font-size * @baseline-line-height) / @adjusted-font-size, em));
		
		// Adjusted relative baseline offset
		.adjusted-offset () {
			position: relative;
			top: round(@offset-top, 8);
		}
		
		// Adjusted font size and line height
		.adjusted-size () {
			font-size: @adjusted-font-size;
			font-size: (round(unit(@adjusted-font-size / @baseline-font-size, rem), 8));
			line-height: round(@adjusted-line-height, 8);
		}
		
		// Adjusted height
		.adjusted-height (@span) {
			.calculate-baseline-vars(@span, @adjusted-font-size);
			
			height: @-line-height;
		}
		.adjusted-max-height (@span) {
			.calculate-baseline-vars(@span, @adjusted-font-size);
			
			max-height: @-line-height;
		}
		.adjusted-min-height (@span) {
			.calculate-baseline-vars(@span, @adjusted-font-size);
			
			min-height: @-line-height;
		}
		
		// Adjusted offset
		.adjusted-top (@span) {
			.calculate-baseline-vars(@span, @adjusted-font-size);
			
			top: (round(@-line-height + @offset-top, 8));
		}
		.adjusted-bottom (@span) {
			.calculate-baseline-vars(@span, @adjusted-font-size);
			
			bottom: (round(@-line-height - @offset-top, 8));
		}
		
		// Adjusted padding
		.adjusted-padding-top (@span) {
			.calculate-baseline-vars(@span, @adjusted-font-size);
			
			padding-top: @-line-height;
		}
		.adjusted-padding-bottom (@span) {
			.calculate-baseline-vars(@span, @adjusted-font-size);
			
			padding-bottom: @-line-height;
		}
		
		// Adjusted margin
		.adjusted-margin-top (@span) {
			.calculate-baseline-vars(@span, @adjusted-font-size);
			
			margin-top: @-line-height;
		}
		.adjusted-margin-top (@span, @offset) {
			.calculate-baseline-vars(@span, @adjusted-font-size);
			
			margin-top: @-line-height;
			margin-top: -webkit-calc(@-line-height ~"+" @offset);
			margin-top: calc(@-line-height ~"+" @offset);
		}
		.adjusted-margin-bottom (@span) {
			.calculate-baseline-vars(@span, @adjusted-font-size);
			
			margin-bottom: (round(@-line-height + @offset-bottom, 8));
		}
		.adjusted-margin-bottom (@span, @offset) {
			.calculate-baseline-vars(@span, @adjusted-font-size);
			
			@-margin-bottom: (round(@-line-height + @offset-bottom, 8));
			
			margin-bottom: @-margin-bottom;
			margin-bottom: -webkit-calc(@-margin-bottom ~"+" @offset);
			margin-bottom: calc(@-margin-bottom ~"+" @offset);
		}
	}
	
	// Adjust baseline and align to baseline
	.adjust-baseline-offset (@--font-size, @-baseline-ratio: 1, @-offset: @baseline-offset) when (ispixel(@--font-size)) {
		.adjust-baseline(@--font-size, @-baseline-ratio, @-offset);
		.adjusted-offset();
	}
	
	// Adjust baseline and set font size and line height
	.adjust-baseline-size (@--font-size, @-baseline-ratio: 1, @-offset: @baseline-offset) when (ispixel(@--font-size)) {
		.adjust-baseline(@--font-size, @-baseline-ratio, @-offset);
		.adjusted-size();
	}
	
	// Adjust baseline and set font size and line height
	.adjust-baseline-offset-and-size (@--font-size, @-baseline-ratio: 1, @-offset: @baseline-offset) when (ispixel(@--font-size)) {
		.adjust-baseline(@--font-size, @-baseline-ratio, @-offset);
		.adjusted-offset();
		.adjusted-size();
	}
}